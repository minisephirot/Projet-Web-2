{% extends "EJLoveBundle:Default:layout.html.twig" %}

{% block title %}
    Partie en cours - {{ parent() }}
{% endblock %}

{% block ll_body %}

    <div id="party" class="container">
        <div class="well">
            <button type="button" class="btn btn-info pulse-danger" data-toggle="collapse" data-target="#debug">Info debuggage</button>
            <div id="debug" class="collapse well">
                Liste des joueurs dans la partie :
                {{ dump(party.partyPlayers)}}
                Liste des scores des joueurs dans la partie :
                {{ dump(party.playerScore)}}
                Est-ce que la partie est demarr√©e (1:Oui/0:Non) :
                {{ dump(party.isStarted)}}
                Est-ce que la partie est finie (1:Oui/0:Non) :
                {{ dump(party.isOver)}}
            </div><br>
            <h1>Partie de {{ party.host }}:</h1><br>
            {% for key, value in party.partyPlayers %}
                <li>{{ value }}</li>
            {% endfor %}
            {% if app.user == party.host %}
                <br><a class="btn btn-primary btn-lg" href="{{ path('LoveBundle_create',{'gameid': party.id})}}">Commencer la partie</a>
            {% endif %}
        </div>
    </div>

    <script type="text/javascript">
        $(function() {
            if ( {{ party.isStarted }} == 1){
                window.location.replace("http://localhost"+"{{ path('LoveBundle_view',{'gameid': party.id})}}");
            }else{
                var auto_refresh = setInterval(
                 function () {
                        // $('#party').load("{{ party.id }} #party").fadeIn("slow");
                        window.location.reload();
                        //alert({{ party.isStarted }})
                }, 5000); // refresh every 2000 milliseconds
            }
                       
        });
        
    </script>
      
{% endblock %}